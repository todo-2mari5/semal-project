{% extends 'base.html' %}

{% block content %}
    <h1 id="botan">kokoyade</h1>

    <div class="container post-contents">
        <div class="row" id="post_list">
            {% for post in posts %}
                <div class="col-10 col-md-6 col-lg-4">
                    <a href="{% url 'myapp:post_detail' pk=post.pk %}">
                        <div class="post-col">
                            <div class="photo-wrapper">
                                <img src="{{ post.thumb.url }}" class="photo-prv">
                            </div>
                            <div class="text-wrapper">
                                <h1>{{ post.title }}</h1>
                                {{ post.event_date|date:"Y/m/d" }}
                            </div>
                        </div>
                    </a>
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}

{% block extrajs %}
  <script>
      function compare(prop){
          return function(a,b){
            if( a[prop] > b[prop]){
                return 1;
            }else if( a[prop] < b[prop] ){
                return -1;
            }
            return 0;
          }
      }

      var post_list = [
          {% for post in posts %}
              {
                  "title": "{{ post.title }}",
                  "date": "{{ post.event_date|date:"Y/m/d" }}",
                  "thumb": "{{ post.thumb.url }}",
                  "pk": "{{ post.pk }}",
              },
          {% endfor %}
      ];

      let sort_post = post_list.sort(compare('date'))

      $(function(){
          $('#botan').click(function(){
              $('#post_list').empty();
              for (const post of sort_post) {
                  $('#post_list').append('<div class="col-10 col-md-6 col-lg-4"><div class="post-col"><div class="photo-wrapper"><img src="'
                                        + post.thumb
                                        +'"class="photo-prv"></div><div class="text-wrapper"><h1><a href="/post/'
                                        + post.pk
                                        + '/">'
                                        + post.title
                                        +'</a></h1>'
                                        +post.date
                                        +'</div></div></div>'
                                        );
              };
          });
      });
  </script>
{% endblock %}